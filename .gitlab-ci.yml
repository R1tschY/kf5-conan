# Global things
cache:
  paths:
    - .venv*/
before_script:
  # route /builds to sb2
  - echo 'use_outside_path("/builds")' > $HOME/.sbrules
  # /builds with target exec policy
  - sudo sed -i 's%sbox_user_home_dir%"/builds"%' /usr/share/scratchbox2/modes/sdk-build/config.lua

  # Install python devel to compile python packages
  - "dev/install-targets-inner zypper -qn in python3-devel"
  # Create conan venv
  - "dev/build-targets-inner dev/commands/prepare-buildenv"

libssh:
  image: "coderus/sailfishos-platform-sdk:latest"
  script:
    - "dev/build-targets-inner dev/commands/create-pkg libssh sailfishos/stable"
  only:
    changes:
      - "libssh/**/*"
